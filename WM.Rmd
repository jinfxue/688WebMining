---
title: "Initial Web Mining"
author: "Jinfei Xue"
date: "Dec 2, 2018"
output:
  html_document:
    df_print: paged
  word_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r, warning=FALSE, message=FALSE}
#install.packages("rvest")
#install.packages("dplyr")
#install.packages("knitr")
#install.packages("tidytext")
#install.packages("ggplot2")
library(rvest)
library(dplyr)
library(knitr)
library(tidytext)
library(ggplot2)
```

## War Timeline

```{r, warning=FALSE, message=FALSE}

url <- "https://www.iwm.org.uk/history/timeline-of-20th-and-21st-century-wars"
timeline <- url %>%
    read_html() %>%
    html_nodes(css = 'strong')%>%
  html_text() 

timeline <- timeline[!timeline %in% c("?C", "?C19", "?C199")]

war <- rep(NA, length(timeline))
time <- rep(NA, length(timeline))
for (i in 1:length(timeline)) {
  war[i] <- unlist(strsplit(timeline[i], ", "))[1]
  time[i] <- unlist(strsplit(timeline[i], ", "))[2]
}
war_tl <- unique(data.frame(war, time))
rownames(war_tl) <- 1:19
kable(war_tl)

```

## Common Factors Research

We first search for some researches about common factors of wars.

### The 8 Main Reasons for War
```{r}
url <- "https://owlcation.com/social-sciences/The-Main-Reasons-For-War"
# 8 Main Reasons
MRW <- url %>%
    read_html() %>%
    html_nodes(xpath = '//*[@id="txtd_45775170"]')%>%
  html_text() 
MRW <- unlist(strsplit(MRW, "\n"))
MRW <- MRW[-9]
# War examples for each main reason
war_ex <- url %>%
    read_html() %>%
    html_nodes(css = 'li strong')%>%
  html_text() 
war_ex <- war_ex[1:23]
# Combine
reasons <- rep(MRW, c(2,3,5,2,2,4,4,1))
mrw <- data.frame(reasons, war_ex)
kable(mrw)

```

We can see the eight main reasons for wars are "Economic Gain", "Territorial Gain", "Religion", "Nationalism", "Revenge", "Civil War", "Revolutionary War" and "Defensive War".

### The Causes of War and Those of Peace
```{r}
url <- "https://www.theobjectivestandard.com/2014/10/causes-war-peace/"
# Wikipedia: Causes of Wars
causes <- url %>%
    read_html() %>%
    html_nodes(css = 'td:nth-child(1) strong')%>%
  html_text() 
causes

```

## the First World War 
```{r}
# The Origins of WWI
url_1 <- "https://www.historyonthenet.com/authentichistory/1914-1920/1-overview/1-origins/index.html"
ww1_1 <- url %>%
    read_html() %>%
    html_nodes(css = 'strong , .body_text .header')%>%
  html_text() 
ww1_1

# 
url_2 <- "https://www.historyonthenet.com/authentichistory/1914-1920/1-overview/1-origins/index.html"
ww1_2 <- url %>%
    read_html() %>%
    html_nodes(css = 'strong , .body_text .header')%>%
  html_text() 
ww1_2

```

## the Second World War 
```{r}
# The Origins of WWI
url_1 <- "https://www.historyonthenet.com/authentichistory/1914-1920/1-overview/1-origins/index.html"
ww1_1 <- url %>%
    read_html() %>%
    html_nodes(css = 'strong , .body_text .header')%>%
  html_text() 
ww1_1

# 
url_2 <- "https://www.historyonthenet.com/authentichistory/1914-1920/1-overview/1-origins/index.html"
ww1_2 <- url %>%
    read_html() %>%
    html_nodes(css = 'strong , .body_text .header')%>%
  html_text() 
ww1_2

```

## the Korean War

```{r, message=FALSE}
url_kw <- c("https://www.historycrunch.com/causes-of-the-korean-war.html#/",
        "https://www.historycentral.com/korea/causes.html", 
        "http://time.com/3915803/korean-war-1950-history/", 
        "http://www.learnkoreanlanguage.com/causes-of-the-korean-war.html", 
        "http://www.bbc.co.uk/history/worldwars/coldwar/korea_hickey_01.shtml", 
        "https://www.enotes.com/homework-help/can-someone-answer-what-were-factors-leading-up-158481")
kw1 <- url_kw[1] %>%
  read_html() %>%
  html_nodes(css = '#wsite-content .paragraph font')%>%
  html_text()
kw2 <- url_kw[2] %>%
  read_html() %>%
  html_nodes(css = '.container .content p')%>%
  html_text()
kw3 <- url_kw[3] %>%
  read_html() %>%
  html_nodes(css = 'p')%>%
  html_text()
kw4 <- url_kw[4] %>%
  read_html() %>%
  html_nodes(css = 'p')%>%
  html_text()
kw5 <- url_kw[5] %>%
  read_html() %>%
  html_nodes(css = '.fr~ p , #four+ p , #three+ p , #two+ p , #one~ p')%>%
  html_text()
kw6 <- url_kw[6] %>%
  read_html() %>%
  html_nodes(css = '.anon-hide p')%>%
  html_text()
kw <- c(kw1, kw2, kw3, kw4, kw5, kw6)

kw_df <- data_frame(text = kw)

#my_stopwords <- data_frame(word = c("38th", "1950")
kw_n <- kw_df %>% 
  unnest_tokens(word, text) %>%
  anti_join(stop_words) %>%
  count(word, sort = TRUE)
kable(kw_n %>% filter(n > 7))

# create a visualization of the most common words 
kw_n %>%
  filter(n > 7) %>%
  mutate(word = reorder(word, n)) %>%
  ggplot(aes(word, n)) +
  geom_col() +
  xlab(NULL) +
  coord_flip()
```

From the table and plot, we can see that there are some words like "north", "south", "china", "american", "japan", "communist", "troops", "military", "cold", "policy", "government", which are related to the causes of the Korean War.

## the Vietnam War

```{r}
url_vw <- c("",
        "", 
        "", 
        "", 
        "", 
        "")
vw1 <- url_vw[1] %>%
  read_html() %>%
  html_nodes(css = '')%>%
  html_text()
vw2 <- url_vw[2] %>%
  read_html() %>%
  html_nodes(css = '')%>%
  html_text()
vw3 <- url_vw[3] %>%
  read_html() %>%
  html_nodes(css = '')%>%
  html_text()
vw4 <- url_vw[4] %>%
  read_html() %>%
  html_nodes(css = '')%>%
  html_text()
vw5 <- url_vw[5] %>%
  read_html() %>%
  html_nodes(css = '')%>%
  html_text()
vw6 <- url_vw[6] %>%
  read_html() %>%
  html_nodes(css = '')%>%
  html_text()
vw <- c(vw1, vw2, vw3, vw4, vw5, vw6)

vw_df <- data_frame(text = vw)


vw_n <- vw_df %>% 
  unnest_tokens(word, text) %>%
  anti_join(stop_words) %>%
  count(word, sort = TRUE)
kable(vw_n %>% filter(n > 7))

# create a visualization of the most common words 
vw_n %>%
  filter(n > 7) %>%
  mutate(word = reorder(word, n)) %>%
  ggplot(aes(word, n)) +
  geom_col() +
  xlab(NULL) +
  coord_flip()
```



##

```{r}
url_vw <- c("",
        "", 
        "", 
        "", 
        "", 
        "")
vw1 <- url_vw[1] %>%
  read_html() %>%
  html_nodes(css = '')%>%
  html_text()
vw2 <- url_vw[2] %>%
  read_html() %>%
  html_nodes(css = '')%>%
  html_text()
vw3 <- url_vw[3] %>%
  read_html() %>%
  html_nodes(css = '')%>%
  html_text()
vw4 <- url_vw[4] %>%
  read_html() %>%
  html_nodes(css = '')%>%
  html_text()
vw5 <- url_vw[5] %>%
  read_html() %>%
  html_nodes(css = '')%>%
  html_text()
vw6 <- url_vw[6] %>%
  read_html() %>%
  html_nodes(css = '')%>%
  html_text()
vw <- c(vw1, vw2, vw3, vw4, vw5, vw6)

vw_df <- data_frame(text = vw)


vw_n <- vw_df %>% 
  unnest_tokens(word, text) %>%
  anti_join(stop_words) %>%
  count(word, sort = TRUE)
kable(vw_n %>% filter(n > 7))

# create a visualization of the most common words 
vw_n %>%
  filter(n > 7) %>%
  mutate(word = reorder(word, n)) %>%
  ggplot(aes(word, n)) +
  geom_col() +
  xlab(NULL) +
  coord_flip()
```





